<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HMPS Informatika UIN Gus Dur</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#"><i class="fas fa-code me-2"></i>HMPS INFORMATIKA</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto text-uppercase fs-6 fw-bold">
                    <li class="nav-item"><a class="nav-link active" href="#home">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link" href="#tentang">Tentang</a></li>
                    <li class="nav-item"><a class="nav-link" href="#divisi">Divisi</a></li>
                    <li class="nav-item"><a class="nav-link" href="#berita">Kegiatan</a></li>
                    <li class="nav-item"><a class="nav-link" href="#kontak">Kontak</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin/">Admin</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="home" class="hero-section text-center d-flex align-items-center">
        <div class="container">
            <span class="badge bg-primary mb-3">UIN K.H. Abdurrahman Wahid Pekalongan</span>
            <h1 class="display-3 fw-bold mb-3">HMPS INFORMATIKA</h1>
            <p class="lead mb-5">Membangun Generasi Teknologi yang Berintegritas, Inovatif, dan Agamis.</p>
            <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                <a href="#divisi" class="btn btn-primary btn-lg px-4 me-sm-3 rounded-pill">Lihat Program</a>
                <a href="#kontak" class="btn btn-outline-light btn-lg px-4 rounded-pill">Hubungi Kami</a>
            </div>
        </div>
    </section>

    <section id="tentang" class="section-padding bg-light">
        <div class="container">
            <h2 class="section-title">Tentang Kami</h2>
            <div class="row justify-content-center mt-5">
                <div class="col-lg-10 text-center">
                    <h3 class="fw-bold mb-3">Siapa HMPS Informatika?</h3>
                    <p class="text-muted mb-5">Himpunan Mahasiswa Program Studi (HMPS) Informatika UIN Gus Dur adalah
                        organisasi eksekutif di tingkat prodi yang menjadi wadah pengembangan minat, bakat, dan potensi
                        mahasiswa di bidang teknologi informasi.</p>

                    <div class="row text-start">
                        <div class="col-md-6">
                            <div class="d-flex mb-3">
                                <div class="flex-shrink-0"><i class="fas fa-check-circle text-primary fa-2x"></i></div>
                                <div class="flex-grow-1 ms-3">
                                    <h5>Visi</h5>
                                    <p class="small text-muted">Menjadi pusat pergerakan mahasiswa informatika yang
                                        unggul dalam riset dan teknologi berbasis nilai keislaman.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex">
                                <div class="flex-shrink-0"><i class="fas fa-rocket text-primary fa-2x"></i></div>
                                <div class="flex-grow-1 ms-3">
                                    <h5>Misi Utama</h5>
                                    <p class="small text-muted">Mengembangkan soft-skill dan hard-skill mahasiswa
                                        melalui pelatihan, workshop, dan kompetisi.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="divisi" class="section-padding">
        <div class="container">
            <h2 class="section-title">Divisi & Departemen</h2>
            <p class="text-center text-muted mb-5">Struktur organisasi penggerak HMPS Informatika.</p>

            <div class="row g-4 justify-content-center">
                <div class="col-md-6 col-lg-4">
                    <div class="divisi-card">
                        <i class="fas fa-user-tie divisi-icon"></i>
                        <h4>BPH</h4>
                        <p class="small text-uppercase text-primary fw-bold mb-2">Badan Pengurus Harian</p>
                        <p class="text-muted">Penanggung jawab utama roda organisasi, administrasi, keuangan, dan
                            koordinasi strategis antar departemen.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="divisi-card">
                        <i class="fas fa-users-cog divisi-icon"></i>
                        <h4>DPA</h4>
                        <p class="small text-uppercase text-primary fw-bold mb-2">Dept. Pemberdayaan Anggota</p>
                        <p class="text-muted">Fokus pada kaderisasi, upgrading skill, menjaga soliditas, dan
                            pengembangan potensi seluruh anggota.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="divisi-card">
                        <i class="fas fa-camera-retro divisi-icon"></i>
                        <h4>DIGMUL</h4>
                        <p class="small text-uppercase text-primary fw-bold mb-2">Dept. Digital & Multimedia</p>
                        <p class="text-muted">Mengelola branding organisasi, konten kreatif media sosial, desain grafis,
                            dan dokumentasi kegiatan.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="divisi-card">
                        <i class="fas fa-laptop-code divisi-icon"></i>
                        <h4>ILTEK</h4>
                        <p class="small text-uppercase text-primary fw-bold mb-2">Dept. Keilmuan & Teknologi</p>
                        <p class="text-muted">Wadah riset teknologi, pelatihan coding, dan pengembangan wawasan akademik
                            mahasiswa Informatika.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="divisi-card">
                        <i class="fas fa-bullhorn divisi-icon"></i>
                        <h4>Advokasi & Humas</h4>
                        <p class="small text-uppercase text-primary fw-bold mb-2">Dept. Advokasi & Humas</p>
                        <p class="text-muted">Menjadi jembatan informasi internal-eksternal serta mengadvokasi aspirasi
                            mahasiswa kepada birokrasi.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="berita" class="section-padding bg-light">
        <div class="container">
            <h2 class="section-title">Kegiatan Terbaru</h2>
            <p class="text-center text-muted mb-5">Dokumentasi kegiatan dan berita terkini HMPS Informatika.</p>

            <div class="row g-4" id="kegiatan-cards">
                <div class="text-center text-muted">Memuat kegiatan…</div>
            </div>
        </div>
    </section>

    <section id="berita-otomatis" class="section-padding">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title">Berita Kampus</h2>
                <p class="text-muted mb-0">Berita terbaru seputar Informatika dan UIN Gus Dur yang ditampilkan otomatis.
                    Kamu tinggal buka halaman ini, tanpa update manual.</p>
            </div>

            <ul class="nav nav-tabs justify-content-center" id="newsTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="tab-uin" data-bs-toggle="tab" data-bs-target="#pane-uin"
                        type="button" role="tab" aria-controls="pane-uin" aria-selected="true">
                        <i class="fas fa-university me-2"></i>UIN Gus Dur
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab-informatika" data-bs-toggle="tab"
                        data-bs-target="#pane-informatika" type="button" role="tab" aria-controls="pane-informatika"
                        aria-selected="false">
                        <i class="fas fa-laptop-code me-2"></i>Informatika
                    </button>
                </li>
            </ul>

            <div class="tab-content border border-top-0 rounded-bottom bg-white p-4 shadow-sm" id="newsTabContent">
                <div class="tab-pane fade show active" id="pane-uin" role="tabpanel" aria-labelledby="tab-uin"
                    tabindex="0">
                    <div
                        class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3 mb-3">
                        <div>
                            <h4 class="fw-bold mb-0">UIN Gus Dur</h4>
                            <small class="text-muted">Sumber: Google News (RSS) • Link mengarah ke
                                uingusdur.ac.id</small>
                        </div>
                        <a class="btn btn-outline-primary" target="_blank" rel="noopener noreferrer" id="openAllUin"
                            href="#">
                            Buka di sumber <i class="fas fa-arrow-up-right-from-square ms-2"></i>
                        </a>
                    </div>

                    <div id="status-uin" class="text-muted mb-3">Memuat berita…</div>
                    <div id="list-uin" class="list-group"></div>
                </div>

                <div class="tab-pane fade" id="pane-informatika" role="tabpanel" aria-labelledby="tab-informatika"
                    tabindex="0">
                    <div
                        class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3 mb-3">
                        <div>
                            <h4 class="fw-bold mb-0">Informatika</h4>
                            <small class="text-muted">Sumber: Google News (RSS)</small>
                        </div>
                        <a class="btn btn-outline-primary" target="_blank" rel="noopener noreferrer"
                            id="openAllInformatika" href="#">
                            Buka di sumber <i class="fas fa-arrow-up-right-from-square ms-2"></i>
                        </a>
                    </div>

                    <div id="status-informatika" class="text-muted mb-3">Memuat berita…</div>
                    <div id="list-informatika" class="list-group"></div>
                </div>
            </div>

            <div class="text-center mt-4">
                <small class="text-muted">Catatan: Jika daftar kosong, coba refresh atau buka lewat tombol “Buka di
                    sumber”.</small>
            </div>
        </div>
    </section>

    <section id="kontak" class="section-padding">
        <div class="container">
            <h2 class="section-title">Hubungi Kami</h2>
            <div class="row mt-5">
                <div class="col-lg-5 mb-4">
                    <div class="bg-white p-4 rounded-4 shadow-sm h-100 border">
                        <h4 class="fw-bold mb-4">Sekretariat</h4>
                        <p><i class="fas fa-map-marker-alt text-primary me-2"></i> Kampus UIN K.H. Abdurrahman Wahid,
                            Kajen, Pekalongan, Jawa Tengah.</p>
                        <p><i class="fas fa-envelope text-primary me-2"></i> hmps.informatika@uingusdur.ac.id</p>
                        <p><i class="fas fa-phone text-primary me-2"></i> +62 812-3456-7890 (Admin)</p>

                        <div class="ratio ratio-16x9 mt-4 rounded overflow-hidden">
                            <iframe
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3960.226077614359!2d109.58755691477334!3d-6.982626394955629!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e70200021000001%3A0x3e5c18471473430d!2sUIN%20K.H.%20Abdurrahman%20Wahid%20Pekalongan!5e0!3m2!1sid!2sid!4v1677821234567!5m2!1sid!2sid"
                                class="map-embed" allowfullscreen="" loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade"></iframe>
                        </div>
                    </div>
                </div>

                <div class="col-lg-7">
                    <div class="bg-white p-4 rounded-4 shadow-sm border">
                        <h4 class="fw-bold mb-4">Kirim Pesan</h4>
                        <form>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Nama Lengkap</label>
                                    <input type="text" class="form-control" placeholder="Nama Anda">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" placeholder="email@contoh.com">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Subjek</label>
                                <input type="text" class="form-control" placeholder="Perihal pesan">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Pesan</label>
                                <textarea class="form-control" rows="5"
                                    placeholder="Tulis pesan Anda di sini..."></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary btn-kirim w-100">Kirim Pesan Sekarang</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container text-center">
            <h5 class="fw-bold">HMPS INFORMATIKA</h5>
            <p class="small mb-4">Universitas Islam Negeri K.H. Abdurrahman Wahid Pekalongan</p>
            <div class="mb-4 social-icons">
                <a href="https://www.instagram.com/hmpsinformatika.uinpkl" target="_blank" class="mx-2 text-white"><i
                        class="fab fa-instagram fa-lg"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-youtube fa-lg"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-tiktok fa-lg"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-github fa-lg"></i></a>
            </div>
            <hr class="mx-auto hr-short">
            <small>© 2025 HMPS Informatika. Developed by <span class="text-white fw-bold">Dept. DigMul</span>.</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        window.addEventListener('scroll', function () {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('shadow');
            } else {
                navbar.classList.remove('shadow');
            }
        });
    </script>

    <script>
        window.addEventListener('DOMContentLoaded', function () {
            const FEEDS = {
                informatika: {
                    rssUrl: "https://news.google.com/rss/search?q=informatika&hl=id&gl=ID&ceid=ID:id",
                    openUrl: "https://news.google.com/search?q=informatika&hl=id&gl=ID&ceid=ID:id",
                    statusId: "status-informatika",
                    listId: "list-informatika",
                    openAllId: "openAllInformatika",
                    limit: 12
                },
                uin: {
                    rssUrl: "https://news.google.com/rss/search?q=site%3Auingusdur.ac.id%20uin%20gus%20dur&hl=id&gl=ID&ceid=ID:id",
                    openUrl: "https://news.google.com/search?q=site%3Auingusdur.ac.id%20uin%20gus%20dur&hl=id&gl=ID&ceid=ID:id",
                    statusId: "status-uin",
                    listId: "list-uin",
                    openAllId: "openAllUin",
                    limit: 12
                }
            };

            function byId(id) {
                return document.getElementById(id);
            }

            function setStatus(id, text) {
                const el = byId(id);
                if (el) el.textContent = text;
            }

            function formatDate(dateStr) {
                const date = new Date(dateStr);
                if (Number.isNaN(date.getTime())) return "";
                return date.toLocaleDateString("id-ID", {
                    day: "2-digit",
                    month: "short",
                    year: "numeric"
                });
            }

            function escapeHtml(text) {
                return String(text)
                    .replaceAll("&", "&amp;")
                    .replaceAll("<", "&lt;")
                    .replaceAll(">", "&gt;")
                    .replaceAll('"', "&quot;")
                    .replaceAll("'", "&#039;");
            }

            async function fetchRssXml(rssUrl) {
                const proxyUrl = "https://api.allorigins.win/raw?url=" + encodeURIComponent(rssUrl);
                const response = await fetch(proxyUrl, { cache: "no-store" });
                if (!response.ok) {
                    throw new Error("Gagal mengambil RSS (" + response.status + ")");
                }
                return await response.text();
            }

            function parseRssItems(xmlText) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(xmlText, "text/xml");
                const items = Array.from(doc.getElementsByTagName("item"));

                const MRSS_NS = "http://search.yahoo.com/mrss/";

                function pickFirstAttrUrl(el, attrName) {
                    const url = el?.getAttribute?.(attrName);
                    return url ? String(url).trim() : "";
                }

                function findImageUrl(item) {
                    const mediaContentNs = item.getElementsByTagNameNS(MRSS_NS, "content")[0];
                    const mediaThumbNs = item.getElementsByTagNameNS(MRSS_NS, "thumbnail")[0];
                    const urlNs = pickFirstAttrUrl(mediaContentNs, "url") || pickFirstAttrUrl(mediaThumbNs, "url");
                    if (urlNs) return urlNs;

                    const mediaContent = item.getElementsByTagName("media:content")[0];
                    const mediaThumb = item.getElementsByTagName("media:thumbnail")[0];
                    const urlPrefixed = pickFirstAttrUrl(mediaContent, "url") || pickFirstAttrUrl(mediaThumb, "url");
                    if (urlPrefixed) return urlPrefixed;

                    const html = item.getElementsByTagName("content:encoded")[0]?.textContent
                        ?? item.getElementsByTagName("description")[0]?.textContent
                        ?? "";
                    const match = String(html).match(/<img[^>]+src=["']([^"']+)["']/i);
                    return match?.[1]?.trim() ?? "";
                }

                return items.map((item) => {
                    const title = item.getElementsByTagName("title")[0]?.textContent?.trim() ?? "";
                    const link = item.getElementsByTagName("link")[0]?.textContent?.trim() ?? "";
                    const pubDate = item.getElementsByTagName("pubDate")[0]?.textContent?.trim() ?? "";
                    const source = item.getElementsByTagName("source")[0]?.textContent?.trim() ?? "";
                    const imageUrl = findImageUrl(item);

                    return { title, link, pubDate, source, imageUrl };
                }).filter((x) => x.title && x.link);
            }

            function renderList(listId, items) {
                const list = byId(listId);
                if (!list) return;

                list.innerHTML = "";

                if (!items.length) {
                    list.innerHTML = '<div class="text-muted">Belum ada berita yang bisa ditampilkan.</div>';
                    return;
                }

                for (const item of items) {
                    const date = formatDate(item.pubDate);
                    const meta = [item.source, date].filter(Boolean).join(" • ");

                    const a = document.createElement("a");
                    a.className = "list-group-item list-group-item-action";
                    a.href = item.link;
                    a.target = "_blank";
                    a.rel = "noopener noreferrer";

                    const thumbHtml = item.imageUrl
                        ? `<img class="news-thumb" src="${escapeHtml(item.imageUrl)}" alt="">`
                        : `<div class="news-thumb news-thumb--placeholder bg-light text-muted d-flex align-items-center justify-content-center">
                                <i class="far fa-image"></i>
                           </div>`;

                    a.innerHTML = `
                        <div class="d-flex justify-content-between align-items-start gap-3">
                            <div class="d-flex align-items-start gap-3">
                                ${thumbHtml}
                                <div>
                                    <div class="fw-semibold">${escapeHtml(item.title)}</div>
                                    ${meta ? `<div class="small text-muted mt-1">${escapeHtml(meta)}</div>` : ""}
                                </div>
                            </div>
                            <div class="text-muted"><i class="fas fa-arrow-up-right-from-square"></i></div>
                        </div>
                    `;

                    list.appendChild(a);
                }
            }

            async function loadFeed(key) {
                const cfg = FEEDS[key];

                const openAll = byId(cfg.openAllId);
                if (openAll) openAll.href = cfg.openUrl;

                try {
                    setStatus(cfg.statusId, "Memuat berita…");
                    const xmlText = await fetchRssXml(cfg.rssUrl);
                    const items = parseRssItems(xmlText).slice(0, cfg.limit);
                    renderList(cfg.listId, items);
                    setStatus(cfg.statusId, items.length ? "" : "Tidak ada berita ditemukan.");
                } catch (err) {
                    renderList(cfg.listId, []);
                    setStatus(cfg.statusId, "Gagal memuat berita. Silakan coba lagi.");
                }
            }

            loadFeed("informatika");
            loadFeed("uin");
        });
    </script>

    <script>
        window.addEventListener('DOMContentLoaded', async function () {
            const container = document.getElementById('kegiatan-cards');
            if (!container) return;

            function formatDate(yyyyMmDd) {
                const d = new Date(yyyyMmDd);
                if (Number.isNaN(d.getTime())) return yyyyMmDd || '';
                return d.toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' });
            }

            function escapeHtml(text) {
                return String(text)
                    .replaceAll('&', '&amp;')
                    .replaceAll('<', '&lt;')
                    .replaceAll('>', '&gt;')
                    .replaceAll('"', '&quot;')
                    .replaceAll("'", '&#039;');
            }

            try {
                const res = await fetch('data/posts.json', { cache: 'no-store' });
                if (!res.ok) throw new Error('Gagal memuat data kegiatan.');
                const data = await res.json();
                const posts = Array.isArray(data?.posts) ? data.posts : [];

                const published = posts
                    .filter(p => p && p.published === true)
                    .sort((a, b) => String(b.date || '').localeCompare(String(a.date || '')))
                    .slice(0, 3);

                if (!published.length) {
                    container.innerHTML = '<div class="text-center text-muted">Belum ada kegiatan.</div>';
                    return;
                }

                container.innerHTML = '';

                for (const p of published) {
                    const href = p.url ? String(p.url) : ('post.html?id=' + encodeURIComponent(p.id || ''));
                    const imgHtml = p.image
                        ? `<img src="${escapeHtml(p.image)}" class="news-img" alt="${escapeHtml(p.title || '')}">`
                        : '';

                    const col = document.createElement('div');
                    col.className = 'col-md-4';
                    col.innerHTML = `
                        <div class="news-card">
                            ${imgHtml}
                            <div class="p-4">
                                <p class="news-date"><i class="far fa-calendar-alt me-2"></i>${escapeHtml(formatDate(p.date))}</p>
                                <h5 class="fw-bold">${escapeHtml(p.title || '')}</h5>
                                <p class="text-muted small">${escapeHtml(p.excerpt || '')}</p>
                                <a href="${escapeHtml(href)}" class="btn-baca">Baca Selengkapnya <i class="fas fa-arrow-right ms-1"></i></a>
                            </div>
                        </div>
                    `;
                    container.appendChild(col);
                }
            } catch (e) {
                container.innerHTML = '<div class="text-center text-muted">Gagal memuat kegiatan.</div>';
            }
        });
    </script>
</body>

</html>
